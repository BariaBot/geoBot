# Руководство по вкладу

> Обновлено: 24 сентября 2025

## Общие принципы
- `main` всегда содержит рабочую версию: никаких прямых коммитов — только merge через Pull Request.
- Каждая задача заводится отдельным Issue; все PR обязаны ссылаться на него (`Closes #ID`).
- Для работы над задачей создаём ветку от свежего `main`. После слияния ветку удаляем, чтобы не копить «висячие» истории.

## Рабочий цикл
1. Обновить `main` и создать ветку под Issue:
   ```bash
   git checkout main
   git pull
   git checkout -b feature/issue-XX-short-slug
   ```
2. Вести коммиты в стиле Conventional Commits (`feat(frontend): ...`, `fix: ...`).
3. Перед пушем синхронизировать зависимости, проверить форматирование и тесты (см. ниже).
4. Открыть PR в `main`, указать ссылку на Issue и включить auto-merge после прохождения проверок.
5. После слияния: удалить удалённую и локальную ветки, обновить `main`.

## Требования к Pull Request
- Заголовок в стиле Conventional Commits, отражает итог изменения.
- В описании:
  - краткий список изменений;
  - строка `Closes #XX` или несколько ссылок на Issues;
  - результаты ручных/автоматизированных проверок.
- При появлении конфликтов синхронизируем ветку `git fetch && git rebase origin/main`.
- Если PR затрагивает UI — приложить скриншоты или GIF.

## Тесты и проверки
- Backend: `mvn -f apps/backend/pom.xml test` (JUnit 5). При необходимости отключайте Liquibase через профиль `integration`.
- Frontend: `npm install && npm run lint && npm run typecheck` в `apps/frontend`. Unit/E2E тесты появятся под `apps/frontend/src/__tests__` по мере развития интерфейса.
- Полный стек: `docker compose -f infra/docker-compose.yml up --build` (экспериментальные проверки перед релизом).
- Любой новый сервис или бизнес-логика — добавляем unit-тесты. При отсутствии тестов фиксируем технический долг в Issue.

## Автоматическое слияние
- После зелёных Checks нажимаем `Enable auto-merge` → `Merge` (линейная история допускается, если правило не запрещает).
- Если GitHub блокирует merge из-за правил, исправляем конфигурацию или выполняем ручной merge от лица, включённого в RuleSet.

## Домашние задачи для команды
- Создавая Issue, описываем ожидаемый результат и критерии приёмки.
- Перед переходом к следующей задаче проверяем, что текущий PR merged и локальный `main` обновлён.
